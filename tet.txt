#!/usr/bin/ksh

CHCK_MIN_UID=201
CHCK_EXC_UID="1 2 50 199 250 300 400 ..."  # tutaj Twoja długa lista

echo "{"
echo "  \"data\":["

FIRST=1

lsuser -c -a id ALL | grep -v '^#' | cut -d= -f2,1 | perl -e '
  use strict;
  use warnings;

  my $first=1;
  # lista wykluczonych UID z zmiennej środowiskowej
  my %excl = map { $_ => 1 } split(/\s+/, $ENV{CHCK_EXC_UID});

  while (<>) {
      chomp;
      my ($uid, $user) = split(/:/, $_);
      next unless $uid >= $ENV{CHCK_MIN_UID};
      next if exists $excl{$uid};

      if ($first==0) { print ",\n"; }
      print "    { \"{#USERNAME}\":\"$user\" }";
      $first=0;
  }
  print "\n";
'
echo "  ]"
echo "}"
